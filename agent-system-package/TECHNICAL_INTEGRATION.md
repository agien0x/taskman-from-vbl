# Technical Integration Guide for @lovable/agent-system

## Table of Contents
- [System Requirements](#system-requirements)
- [Dependencies](#dependencies)
- [Project Structure](#project-structure)
- [External Components](#external-components)
- [Database Setup](#database-setup)
- [Edge Functions](#edge-functions)
- [Configuration](#configuration)
- [Integration Steps](#integration-steps)
- [Verification Checklist](#verification-checklist)
- [Troubleshooting](#troubleshooting)
- [Advanced Configuration](#advanced-configuration)
- [Production Considerations](#production-considerations)

---

## System Requirements

### Minimum Requirements
- **Node.js**: ≥18.x
- **React**: 18.3.1 or 19.0.0
- **Supabase Project**: Active project with enabled extensions
- **TypeScript**: Recommended (optional)

### Required Supabase Extensions
- `pg_net` - For asynchronous HTTP requests from database triggers
- `pg_cron` - For scheduled trigger execution (optional)
- `pgvector` - For embeddings support (optional, for task similarity)

---

## Dependencies

### 1. Peer Dependencies (MUST be installed in your project)

These packages MUST be present in your project. The `@lovable/agent-system` package will not work without them:

```bash
npm install react@^18.3.1 react-dom@^18.3.1 \
  @supabase/supabase-js@^2.76.1 \
  @dnd-kit/core@^6.3.1 \
  @dnd-kit/sortable@^10.0.0 \
  @dnd-kit/utilities@^3.2.2 \
  lucide-react@^0.462.0 \
  @radix-ui/react-dialog@^1.1.14 \
  @radix-ui/react-select@^2.2.5 \
  @radix-ui/react-tabs@^1.1.12 \
  @radix-ui/react-popover@^1.1.14 \
  @radix-ui/react-scroll-area@^1.2.9 \
  @radix-ui/react-tooltip@^1.2.7 \
  @radix-ui/react-separator@^1.1.7 \
  @radix-ui/react-switch@^1.2.5 \
  @radix-ui/react-label@^2.1.7 \
  @radix-ui/react-checkbox@^1.3.2 \
  @radix-ui/react-hover-card@^1.1.14 \
  @radix-ui/react-dropdown-menu@^2.1.15 \
  @radix-ui/react-slot@^1.2.3 \
  @tiptap/react@^3.7.2 \
  @tiptap/starter-kit@^3.7.2 \
  @tiptap/extension-placeholder@^3.7.2 \
  @tiptap/extension-image@^3.7.2 \
  @tiptap/extension-mention@^3.7.2 \
  @tiptap/extension-task-list@^3.7.2 \
  @tiptap/extension-task-item@^3.7.2 \
  @tiptap/extension-highlight@^3.7.2 \
  @tiptap/suggestion@^3.7.2 \
  cmdk@^1.1.1 \
  class-variance-authority@^0.7.1 \
  date-fns@^3.6.0 \
  recharts@^2.15.4 \
  sonner@^1.7.4
```

### 2. Automatically Included Dependencies

These are bundled with the package:
```json
{
  "clsx": "^2.1.1",
  "tailwind-merge": "^2.6.0"
}
```

> **Note**: `jsonpath-plus` is used only in the Edge Function `test-agent` via Deno ESM import and is NOT required in your project.

### 3. Tailwind CSS Setup

Your project MUST have Tailwind CSS configured. Add to your `tailwind.config.js`:

```javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/**/*.{js,jsx,ts,tsx}",
    "./node_modules/@lovable/agent-system/dist/**/*.{js,jsx}"
  ],
  theme: {
    extend: {
      // Your custom theme extensions
    },
  },
  plugins: [require("tailwindcss-animate")],
}
```

---

## Project Structure

After integration, your project should look like this:

```
your-project/
├── src/
│   ├── integrations/
│   │   └── supabase/
│   │       ├── client.ts          # ✅ Required: Supabase client instance
│   │       └── types.ts           # Auto-generated by Supabase
│   ├── hooks/
│   │   └── use-toast.ts           # ✅ Required: Toast hook implementation
│   ├── components/
│   │   └── ui/                    # ✅ Required: Radix UI + shadcn/ui components
│   │       ├── button.tsx
│   │       ├── dialog.tsx
│   │       ├── tabs.tsx
│   │       ├── select.tsx
│   │       ├── popover.tsx
│   │       ├── scroll-area.tsx
│   │       ├── tooltip.tsx
│   │       ├── separator.tsx
│   │       ├── switch.tsx
│   │       ├── label.tsx
│   │       ├── checkbox.tsx
│   │       ├── hover-card.tsx
│   │       ├── dropdown-menu.tsx
│   │       ├── badge.tsx
│   │       ├── card.tsx
│   │       ├── input.tsx
│   │       ├── textarea.tsx
│   │       ├── command.tsx
│   │       ├── alert.tsx
│   │       └── sonner.tsx
│   ├── pages/
│   │   └── Agents.tsx             # Your agents page
│   ├── lib/
│   │   └── utils.ts               # cn() utility for Tailwind
│   └── App.tsx                    # Root with AgentSystemProvider
├── supabase/
│   ├── migrations/                # ← Copied from npm package via CLI
│   │   ├── 001_create_agents_table.sql
│   │   ├── 002_create_agent_executions_table.sql
│   │   ├── 003_create_trigger_executions_table.sql
│   │   └── 004_create_supporting_tables.sql
│   ├── functions/                 # ← Copied from npm package via CLI
│   │   ├── test-agent/
│   │   │   └── index.ts
│   │   ├── check-and-execute-triggers/
│   │   │   └── index.ts
│   │   ├── list-tables/
│   │   │   └── index.ts
│   │   └── list-columns/
│   │       └── index.ts
│   └── config.toml                # Supabase configuration
├── agent-system.config.ts         # ← Created by CLI (optional)
├── tailwind.config.js             # ✅ Required
├── package.json
└── .env                           # Supabase credentials
```

---

## External Components

### 1. Supabase Client (Required)

Create `src/integrations/supabase/client.ts`:

```typescript
import { createClient } from '@supabase/supabase-js';
import type { Database } from './types';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Missing Supabase environment variables');
}

export const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey);
```

### 2. Toast Hook (Required)

**IMPORTANT**: The package exports a complete `useToast` hook implementation. You have two options:

#### Option A: Use the exported hook (Recommended)

Simply import and use the hook from the package:

```typescript
// In your components
import { useToast } from '@lovable/agent-system';

function MyComponent() {
  const { toast } = useToast();
  
  toast({
    title: "Success",
    description: "Operation completed",
  });
}
```

**You MUST also have these UI components** for the toast system to work:
- `src/components/ui/toast.tsx` - Toast primitives (Radix UI Toast)
- `src/components/ui/toaster.tsx` - Toast container component

These are **NOT** included in the package and must be in your project.

#### Option B: Use your own implementation

If you prefer to use `sonner` or another toast library, you can pass a custom toast function as a prop to `AgentDialog`:

```typescript
// src/hooks/use-toast.ts (your custom implementation)
import { toast as sonnerToast } from 'sonner';

export const useToast = () => {
  const toast = ({
    title,
    description,
    variant = 'default',
  }: {
    title?: string;
    description?: string;
    variant?: 'default' | 'destructive';
  }) => {
    if (variant === 'destructive') {
      sonnerToast.error(title || 'Error', { description });
    } else {
      sonnerToast.success(title || 'Success', { description });
    }
  };

  return { toast };
};
```

**Then pass it to AgentDialog**:
```typescript
import { useToast } from '@/hooks/use-toast'; // your custom hook

<AgentDialog
  supabaseClient={supabase}
  toast={toast} // your custom implementation
  onSave={() => {}}
/>
```

### 3. UI Components (Required)

You MUST have these shadcn/ui components in `src/components/ui/`:

**Installation (if not present):**
```bash
npx shadcn-ui@latest add button dialog tabs select popover scroll-area tooltip separator switch label checkbox hover-card dropdown-menu badge card input textarea command alert sonner table
```

**Component Checklist** (21 components):
- ✅ `button.tsx` - Button component with variants
- ✅ `dialog.tsx` - Modal dialogs
- ✅ `tabs.tsx` - Tab navigation
- ✅ `select.tsx` - Dropdown select
- ✅ `popover.tsx` - Popover menus
- ✅ `scroll-area.tsx` - Scrollable areas
- ✅ `tooltip.tsx` - Tooltips
- ✅ `separator.tsx` - Visual separators
- ✅ `switch.tsx` - Toggle switches
- ✅ `label.tsx` - Form labels
- ✅ `checkbox.tsx` - Checkboxes
- ✅ `hover-card.tsx` - Hover cards
- ✅ `dropdown-menu.tsx` - Dropdown menus
- ✅ `badge.tsx` - Badges
- ✅ `card.tsx` - Card containers
- ✅ `input.tsx` - Text inputs
- ✅ `textarea.tsx` - Text areas
- ✅ `command.tsx` - Command palette
- ✅ `alert.tsx` - Alert messages
- ✅ `sonner.tsx` - Toast notifications
- ✅ `table.tsx` - Table components (для AgentExecutionTable)

**Additional Required Components** (NOT installed via shadcn-ui):
- ✅ `toast.tsx` - Toast notification primitives (required for Option A toast system)
- ✅ `toaster.tsx` - Toast container component (required for Option A toast system)

**Package-Specific Components** (exported by @lovable/agent-system, no action needed):
- `SlashCommandMenu.tsx` - Slash command menu for editors
- `VoiceInputWithAgents.tsx` - Voice input with agent integration
- `chart.tsx` components - Chart visualization (ChartContainer, ChartTooltip, ChartTooltipContent)

---

#### Full Component Code Reference

Below is the complete code for all required UI components. These are standard shadcn/ui components that you can copy directly to your project.

<details>
<summary><strong>1. button.tsx</strong> - Компонент кнопки с вариантами стилей</summary>

```typescript
// src/components/ui/button.tsx
// Базовый компонент кнопки с поддержкой различных вариантов (default, destructive, outline, secondary, ghost, link)
// Использует class-variance-authority для управления вариантами стилей
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { cva, type VariantProps } from "class-variance-authority";
import { cn } from "@/lib/utils";

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive: "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        outline: "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
        secondary: "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";
    return <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />;
  },
);
Button.displayName = "Button";

export { Button, buttonVariants };
```
</details>

<details>
<summary><strong>2. dialog.tsx</strong> - Модальные диалоговые окна</summary>

```typescript
// src/components/ui/dialog.tsx
// Компонент модального окна на основе Radix UI Dialog
// Поддерживает overlay, анимации открытия/закрытия и опциональную кнопку закрытия
import * as React from "react";
import * as DialogPrimitive from "@radix-ui/react-dialog";
import { X } from "lucide-react";
import { cn } from "@/lib/utils";

const Dialog = DialogPrimitive.Root;
const DialogTrigger = DialogPrimitive.Trigger;
const DialogPortal = DialogPrimitive.Portal;
const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className,
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content> & { hideClose?: boolean }
>(({ className, children, hideClose, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className,
      )}
      {...props}
    >
      {children}
      {!hideClose && (
        <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none">
          <X className="h-4 w-4" />
          <span className="sr-only">Close</span>
        </DialogPrimitive.Close>
      )}
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-1.5 text-center sm:text-left", className)} {...props} />
);
DialogHeader.displayName = "DialogHeader";

const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
DialogFooter.displayName = "DialogFooter";

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold leading-none tracking-tight", className)}
    {...props}
  />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};
```
</details>

<details>
<summary><strong>3. tabs.tsx</strong> - Компонент табов для навигации</summary>

```typescript
// src/components/ui/tabs.tsx
// Компонент вкладок на основе Radix UI Tabs
// Позволяет переключаться между различными разделами контента
import * as React from "react";
import * as TabsPrimitive from "@radix-ui/react-tabs";
import { cn } from "@/lib/utils";

const Tabs = TabsPrimitive.Root;

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
      className,
    )}
    {...props}
  />
));
TabsList.displayName = TabsPrimitive.List.displayName;

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",
      className,
    )}
    {...props}
  />
));
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName;

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className,
    )}
    {...props}
  />
));
TabsContent.displayName = TabsPrimitive.Content.displayName;

export { Tabs, TabsList, TabsTrigger, TabsContent };
```
</details>

<details>
<summary><strong>4. select.tsx</strong> - Выпадающий список для выбора значений</summary>

```typescript
// src/components/ui/select.tsx
// Компонент выпадающего списка на основе Radix UI Select
// Поддерживает группировку, разделители и прокрутку
import * as React from "react";
import * as SelectPrimitive from "@radix-ui/react-select";
import { Check, ChevronDown, ChevronUp } from "lucide-react";
import { cn } from "@/lib/utils";

const Select = SelectPrimitive.Root;
const SelectGroup = SelectPrimitive.Group;
const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className,
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn("flex cursor-default items-center justify-center py-1", className)}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn("flex cursor-default items-center justify-center py-1", className)}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className,
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" &&
            "w-full min-w-[var(--radix-select-trigger-width)]",
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label ref={ref} className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)} {...props} />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>
    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};
```
</details>

<details>
<summary><strong>5. popover.tsx</strong> - Всплывающее меню</summary>

```typescript
// src/components/ui/popover.tsx
// Компонент всплывающего меню на основе Radix UI Popover
// Используется для отображения дополнительного контента при клике
import * as React from "react";
import * as PopoverPrimitive from "@radix-ui/react-popover";
import { cn } from "@/lib/utils";

const Popover = PopoverPrimitive.Root;
const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };
```
</details>

<details>
<summary><strong>6. scroll-area.tsx</strong> - Прокручиваемая область</summary>

```typescript
// src/components/ui/scroll-area.tsx
// Компонент прокручиваемой области на основе Radix UI ScrollArea
// Предоставляет кастомную полосу прокрутки с плавной анимацией
import * as React from "react";
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area";
import { cn } from "@/lib/utils";

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root ref={ref} className={cn("relative overflow-hidden", className)} {...props}>
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit] [&>div]:!block">{children}</ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
));
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName;

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = "vertical", ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      "flex touch-none select-none transition-colors",
      orientation === "vertical" && "h-full w-2.5 border-l border-l-transparent p-[1px]",
      orientation === "horizontal" && "h-2.5 flex-col border-t border-t-transparent p-[1px]",
      className,
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
));
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName;

export { ScrollArea, ScrollBar };
```
</details>

<details>
<summary><strong>7. tooltip.tsx</strong> - Всплывающие подсказки</summary>

```typescript
// src/components/ui/tooltip.tsx
// Компонент всплывающих подсказок на основе Radix UI Tooltip
// Отображает контекстную информацию при наведении на элемент
import * as React from "react";
import * as TooltipPrimitive from "@radix-ui/react-tooltip";
import { cn } from "@/lib/utils";

const TooltipProvider = TooltipPrimitive.Provider;
const Tooltip = TooltipPrimitive.Root;
const TooltipTrigger = TooltipPrimitive.Trigger;

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Portal>
    <TooltipPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-[100] overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </TooltipPrimitive.Portal>
));
TooltipContent.displayName = TooltipPrimitive.Content.displayName;

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };
```
</details>

<details>
<summary><strong>8. separator.tsx</strong> - Визуальный разделитель</summary>

```typescript
// src/components/ui/separator.tsx
// Компонент визуального разделителя на основе Radix UI Separator
// Используется для разделения секций контента (горизонтально или вертикально)
import * as React from "react";
import * as SeparatorPrimitive from "@radix-ui/react-separator";
import { cn } from "@/lib/utils";

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(({ className, orientation = "horizontal", decorative = true, ...props }, ref) => (
  <SeparatorPrimitive.Root
    ref={ref}
    decorative={decorative}
    orientation={orientation}
    className={cn("shrink-0 bg-border", orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]", className)}
    {...props}
  />
));
Separator.displayName = SeparatorPrimitive.Root.displayName;

export { Separator };
```
</details>

<details>
<summary><strong>9. switch.tsx</strong> - Переключатель (toggle)</summary>

```typescript
// src/components/ui/switch.tsx
// Компонент переключателя на основе Radix UI Switch
// Предоставляет визуально привлекательный переключатель вкл/выкл
import * as React from "react";
import * as SwitchPrimitives from "@radix-ui/react-switch";
import { cn } from "@/lib/utils";

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",
      className,
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0",
      )}
    />
  </SwitchPrimitives.Root>
));
Switch.displayName = SwitchPrimitives.Root.displayName;

export { Switch };
```
</details>

<details>
<summary><strong>10. label.tsx</strong> - Метка для форм</summary>

```typescript
// src/components/ui/label.tsx
// Компонент метки (label) на основе Radix UI Label
// Используется для подписей к элементам форм
import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label";
import { cva, type VariantProps } from "class-variance-authority";
import { cn } from "@/lib/utils";

const labelVariants = cva("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70");

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> & VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root ref={ref} className={cn(labelVariants(), className)} {...props} />
));
Label.displayName = LabelPrimitive.Root.displayName;

export { Label };
```
</details>

<details>
<summary><strong>11. checkbox.tsx</strong> - Чекбокс</summary>

```typescript
// src/components/ui/checkbox.tsx
// Компонент чекбокса на основе Radix UI Checkbox
// Предоставляет стилизованный checkbox с галочкой при выборе
import * as React from "react";
import * as CheckboxPrimitive from "@radix-ui/react-checkbox";
import { Check } from "lucide-react";
import { cn } from "@/lib/utils";

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
      className,
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator className={cn("flex items-center justify-center text-current")}>
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };
```
</details>

<details>
<summary><strong>12. hover-card.tsx</strong> - Карточка при наведении</summary>

```typescript
// src/components/ui/hover-card.tsx
// Компонент карточки при наведении на основе Radix UI HoverCard
// Отображает дополнительный контент при наведении мыши
import * as React from "react";
import * as HoverCardPrimitive from "@radix-ui/react-hover-card";
import { cn } from "@/lib/utils";

const HoverCard = HoverCardPrimitive.Root;
const HoverCardTrigger = HoverCardPrimitive.Trigger;

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      "z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName;

export { HoverCard, HoverCardTrigger, HoverCardContent };
```
</details>

<details>
<summary><strong>13. dropdown-menu.tsx</strong> - Выпадающее меню</summary>

```typescript
// src/components/ui/dropdown-menu.tsx
// Компонент выпадающего меню на основе Radix UI DropdownMenu
// Поддерживает группировку, разделители, чекбоксы и радио-кнопки
import * as React from "react";
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
import { Check, ChevronRight, Circle } from "lucide-react";
import { cn } from "@/lib/utils";

const DropdownMenu = DropdownMenuPrimitive.Root;
const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;
const DropdownMenuGroup = DropdownMenuPrimitive.Group;
const DropdownMenuPortal = DropdownMenuPrimitive.Portal;
const DropdownMenuSub = DropdownMenuPrimitive.Sub;
const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)}
    {...props}
  />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest opacity-60", className)} {...props} />;
};
DropdownMenuShortcut.displayName = "DropdownMenuShortcut";

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};
```
</details>

<details>
<summary><strong>14. badge.tsx</strong> - Значок (бейдж)</summary>

```typescript
// src/components/ui/badge.tsx
// Компонент значка (badge) для отображения статусов, меток и категорий
// Поддерживает различные варианты стилей (default, secondary, destructive, outline)
import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority";
import { cn } from "@/lib/utils";

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default: "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary: "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive: "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

export interface BadgeProps extends React.HTMLAttributes<HTMLDivElement>, VariantProps<typeof badgeVariants> {}

const Badge = React.forwardRef<HTMLDivElement, BadgeProps>(
  ({ className, variant, ...props }, ref) => {
    return <div ref={ref} className={cn(badgeVariants({ variant }), className)} {...props} />;
  }
);
Badge.displayName = "Badge";

export { Badge, badgeVariants };
```
</details>

<details>
<summary><strong>15. card.tsx</strong> - Контейнер-карточка</summary>

```typescript
// src/components/ui/card.tsx
// Компонент карточки для группировки связанного контента
// Включает элементы: Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter
import * as React from "react";
import { cn } from "@/lib/utils";

const Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("rounded-lg border bg-card text-card-foreground shadow-sm", className)} {...props} />
));
Card.displayName = "Card";

const CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex flex-col space-y-1.5 p-6", className)} {...props} />
  ),
);
CardHeader.displayName = "CardHeader";

const CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h3 ref={ref} className={cn("text-2xl font-semibold leading-none tracking-tight", className)} {...props} />
  ),
);
CardTitle.displayName = "CardTitle";

const CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => (
    <p ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
  ),
);
CardDescription.displayName = "CardDescription";

const CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />,
);
CardContent.displayName = "CardContent";

const CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("flex items-center p-6 pt-0", className)} {...props} />
  ),
);
CardFooter.displayName = "CardFooter";

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };
```
</details>

<details>
<summary><strong>16. input.tsx</strong> - Текстовое поле ввода</summary>

```typescript
// src/components/ui/input.tsx
// Компонент текстового поля ввода
// ПРИМЕЧАНИЕ: Включает дополнительную логику для slash-команд (опционально)
import * as React from "react";
import { cn } from "@/lib/utils";

interface InputProps extends React.ComponentProps<"input"> {
  enableSlashCommand?: boolean;
}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    // Базовая версия без slash-команд
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className,
        )}
        ref={ref}
        {...props}
      />
    );
  },
);
Input.displayName = "Input";

export { Input };
```
</details>

<details>
<summary><strong>17. textarea.tsx</strong> - Многострочное текстовое поле</summary>

```typescript
// src/components/ui/textarea.tsx
// Компонент многострочного текстового поля
// ПРИМЕЧАНИЕ: Включает дополнительную логику для slash-команд (опционально)
import * as React from "react";
import { cn } from "@/lib/utils";

export interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {
  enableSlashCommand?: boolean;
}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    // Базовая версия без slash-команд
    return (
      <textarea
        className={cn(
          "flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
          className,
        )}
        ref={ref}
        {...props}
      />
    );
  },
);
Textarea.displayName = "Textarea";

export { Textarea };
```
</details>

<details>
<summary><strong>18. command.tsx</strong> - Командная палитра (Command Palette)</summary>

```typescript
// src/components/ui/command.tsx
// Компонент командной палитры на основе cmdk
// Используется для быстрого поиска и выполнения команд
import * as React from "react";
import { type DialogProps } from "@radix-ui/react-dialog";
import { Command as CommandPrimitive } from "cmdk";
import { Search } from "lucide-react";
import { cn } from "@/lib/utils";
import { Dialog, DialogContent } from "@/components/ui/dialog";

const Command = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive>
>(({ className, ...props }, ref) => (
  <CommandPrimitive
    ref={ref}
    className={cn(
      "flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",
      className,
    )}
    {...props}
  />
));
Command.displayName = CommandPrimitive.displayName;

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
};

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        "flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",
        className,
      )}
      {...props}
    />
  </div>
));
CommandInput.displayName = CommandPrimitive.Input.displayName;

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List
    ref={ref}
    className={cn("max-h-[500px] overflow-y-auto overflow-x-hidden", className)}
    {...props}
  />
));
CommandList.displayName = CommandPrimitive.List.displayName;

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => <CommandPrimitive.Empty ref={ref} className="py-6 text-center text-sm" {...props} />);
CommandEmpty.displayName = CommandPrimitive.Empty.displayName;

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      "overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",
      className,
    )}
    {...props}
  />
));
CommandGroup.displayName = CommandPrimitive.Group.displayName;

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Separator ref={ref} className={cn("-mx-1 h-px bg-border", className)} {...props} />
));
CommandSeparator.displayName = CommandPrimitive.Separator.displayName;

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className,
    )}
    {...props}
  />
));
CommandItem.displayName = CommandPrimitive.Item.displayName;

const CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
CommandShortcut.displayName = "CommandShortcut";

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
};
```
</details>

<details>
<summary><strong>19. alert.tsx</strong> - Сообщения и уведомления</summary>

```typescript
// src/components/ui/alert.tsx
// Компонент для отображения информационных сообщений и уведомлений
// Поддерживает варианты: default, destructive
import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority";
import { cn } from "@/lib/utils";

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive: "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div ref={ref} role="alert" className={cn(alertVariants({ variant }), className)} {...props} />
));
Alert.displayName = "Alert";

const AlertTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(
  ({ className, ...props }, ref) => (
    <h5 ref={ref} className={cn("mb-1 font-medium leading-none tracking-tight", className)} {...props} />
  ),
);
AlertTitle.displayName = "AlertTitle";

const AlertDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => (
    <div ref={ref} className={cn("text-sm [&_p]:leading-relaxed", className)} {...props} />
  ),
);
AlertDescription.displayName = "AlertDescription";

export { Alert, AlertTitle, AlertDescription };
```
</details>

<details>
<summary><strong>20. sonner.tsx</strong> - Toast-уведомления (Sonner)</summary>

```typescript
// src/components/ui/sonner.tsx
// Компонент Toast-уведомлений на основе библиотеки Sonner
// Предоставляет стильные всплывающие уведомления с поддержкой тем
// ПРИМЕЧАНИЕ: Зависит от ThemeContext (можно упростить)
import React from "react";
import { Toaster as Sonner, toast } from "sonner";

type ToasterProps = React.ComponentProps<typeof Sonner>;

const Toaster = ({ ...props }: ToasterProps) => {
  // Упрощенная версия без ThemeContext
  return (
    <Sonner
      theme="light"
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            "group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",
          description: "group-[.toast]:text-muted-foreground",
          actionButton: "group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",
          cancelButton: "group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",
        },
      }}
      {...props}
    />
  );
};

export { Toaster, toast };
```
</details>

<details>
<summary><strong>21. table.tsx</strong> - Компоненты таблиц для отображения данных</summary>

```typescript
// src/components/ui/table.tsx
// Набор компонентов для создания таблиц (Table, TableHeader, TableBody, TableRow, TableCell)
// Используется в AgentExecutionTable для отображения истории выполнений агентов
import * as React from "react";
import { cn } from "@/lib/utils";

const Table = React.forwardRef<HTMLTableElement, React.HTMLAttributes<HTMLTableElement>>(
  ({ className, ...props }, ref) => (
    <div className="relative w-full overflow-auto">
      <table ref={ref} className={cn("w-full caption-bottom text-sm", className)} {...props} />
    </div>
  ),
);
Table.displayName = "Table";

const TableHeader = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />,
);
TableHeader.displayName = "TableHeader";

const TableBody = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => (
    <tbody ref={ref} className={cn("[&_tr:last-child]:border-0", className)} {...props} />
  ),
);
TableBody.displayName = "TableBody";

const TableFooter = React.forwardRef<HTMLTableSectionElement, React.HTMLAttributes<HTMLTableSectionElement>>(
  ({ className, ...props }, ref) => (
    <tfoot ref={ref} className={cn("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0", className)} {...props} />
  ),
);
TableFooter.displayName = "TableFooter";

const TableRow = React.forwardRef<HTMLTableRowElement, React.HTMLAttributes<HTMLTableRowElement>>(
  ({ className, ...props }, ref) => (
    <tr
      ref={ref}
      className={cn("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50", className)}
      {...props}
    />
  ),
);
TableRow.displayName = "TableRow";

const TableHead = React.forwardRef<HTMLTableCellElement, React.ThHTMLAttributes<HTMLTableCellElement>>(
  ({ className, ...props }, ref) => (
    <th
      ref={ref}
      className={cn(
        "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
        className,
      )}
      {...props}
    />
  ),
);
TableHead.displayName = "TableHead";

const TableCell = React.forwardRef<HTMLTableCellElement, React.TdHTMLAttributes<HTMLTableCellElement>>(
  ({ className, ...props }, ref) => (
    <td ref={ref} className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)} {...props} />
  ),
);
TableCell.displayName = "TableCell";

const TableCaption = React.forwardRef<HTMLTableCaptionElement, React.HTMLAttributes<HTMLTableCaptionElement>>(
  ({ className, ...props }, ref) => (
    <caption ref={ref} className={cn("mt-4 text-sm text-muted-foreground", className)} {...props} />
  ),
);
TableCaption.displayName = "TableCaption";

export { Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption };
```
</details>

---

**Примечания:**
1. Все компоненты используют `cn()` утилиту из `@/lib/utils` для объединения классов Tailwind
2. Компоненты `input.tsx` и `textarea.tsx` упрощены - базовые версии без slash-команд
3. Если вы хотите использовать встроенный toast hook из пакета (Option A), вам также нужны:
   - `toast.tsx` - базовые примитивы (Radix UI Toast)
   - `toaster.tsx` - контейнер для toast'ов
4. Компонент `table.tsx` критически важен для `AgentExecutionTable`
5. Компонент `chart.tsx` используется в `AgentAnalytics`, но экспортируется из пакета

**Все 21 компонент присутствуют и проверены ✅**

### 4. Utility Function (Required)

Create `src/lib/utils.ts`:

```typescript
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

---

## Database Setup

### 1. Prerequisites Function

**CRITICAL**: This function MUST exist BEFORE applying migrations!

Create a migration file or run directly in SQL editor:

```sql
-- Create update_updated_at_column function
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

### 2. Database Schema Functions (Required for Destinations Editor)

These functions enable dynamic table/column selection in the UI:

```sql
-- Function to list all public tables
CREATE OR REPLACE FUNCTION get_public_tables()
RETURNS TABLE(table_name text, table_schema text)
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path TO 'public'
AS $$
  SELECT table_name::text, table_schema::text
  FROM information_schema.tables
  WHERE table_schema = 'public' 
    AND table_type = 'BASE TABLE'
  ORDER BY table_name;
$$;

-- Function to list columns for a specific table
CREATE OR REPLACE FUNCTION get_table_columns(p_table_name text)
RETURNS TABLE(column_name text, data_type text, is_nullable text)
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path TO 'public'
AS $$
  SELECT column_name::text, data_type::text, is_nullable::text
  FROM information_schema.columns
  WHERE table_schema = 'public' 
    AND table_name = p_table_name
  ORDER BY ordinal_position;
$$;
```

### 3. Migrations Overview

The package includes 4 SQL migration files that create the following tables:

#### Migration 001: `public.agents`
Main table for storing agent configurations.

**Columns:**
- `id` (uuid, primary key)
- `name` (text) - Agent name
- `model` (text) - AI model identifier (e.g., "x-ai/grok-beta")
- `prompt` (text) - Main prompt text
- `modules` (jsonb) - Array of module configurations
- `pitch` (text) - Short agent description (≤7 words)
- `trigger_config` (jsonb) - Trigger configuration
- `router_config` (jsonb) - Routing rules configuration
- `inputs` (jsonb) - Input elements array
- `outputs` (jsonb) - Output destinations array
- `inputs_raw` (text) - Raw HTML/text of inputs field
- `router_raw` (text) - Raw HTML/text of routing rules
- `icon_url` (text) - Agent icon URL
- `channels` (jsonb) - Notification channels (optional)
- `channel_message` (text) - Channel message template (optional)
- `last_trigger_execution` (timestamp) - Last scheduled trigger run
- `created_at` (timestamp)
- `updated_at` (timestamp)

**RLS Policies:**
- Anyone can view all agents
- Authenticated users can create agents
- Authenticated users can update agents

**Indexes:**
- `idx_agents_name` on `name`
- `idx_agents_created_at` on `created_at`

**Trigger:**
- `update_agents_updated_at` - Auto-updates `updated_at` on changes

#### Migration 002: `public.agent_executions`
Logs all agent executions with detailed module chain information.

**Columns:**
- `id` (uuid, primary key)
- `agent_id` (uuid, foreign key to agents)
- `execution_type` (text) - "test", "trigger", "manual", etc.
- `input_data` (jsonb) - Input data passed to agent
- `output_data` (jsonb) - Final output from agent
- `context` (jsonb) - Execution context (source, taskId, etc.)
- `modules_chain` (jsonb) - Detailed log of each module execution
- `status` (text) - "success", "error", "partial"
- `error_message` (text) - Error details if failed
- `duration_ms` (integer) - Execution time in milliseconds
- `rating` (integer) - User rating (1-5)
- `rating_comment` (text) - User feedback
- `rated_by` (text) - User who rated
- `rated_at` (timestamp) - When rated
- `created_at` (timestamp)

**RLS Policies:**
- Anyone can view all executions
- Authenticated users can insert executions
- Authenticated users can update ratings

**Indexes:**
- `idx_agent_executions_agent_id` on `agent_id`
- `idx_agent_executions_created_at` on `created_at`
- `idx_agent_executions_status` on `status`

#### Migration 003: `public.trigger_executions`
Logs trigger events and their outcomes.

**Columns:**
- `id` (uuid, primary key)
- `agent_id` (uuid, foreign key to agents)
- `trigger_type` (text) - "on_create", "on_update", "scheduled", "on_demand"
- `source_entity_type` (text) - "tasks", "profiles", etc.
- `source_entity_id` (text) - ID of the entity that triggered
- `changed_fields` (jsonb) - Which fields changed (for on_update)
- `conditions_met` (boolean) - Whether trigger conditions passed
- `executed` (boolean) - Whether agent was actually executed
- `execution_id` (uuid) - Link to agent_executions if executed
- `error_message` (text) - Error details if failed
- `created_at` (timestamp)

**RLS Policies:**
- Anyone can view all trigger executions
- System can insert trigger executions

**Indexes:**
- `idx_trigger_executions_agent_id` on `agent_id`
- `idx_trigger_executions_created_at` on `created_at`
- `idx_trigger_executions_source` on `source_entity_type`, `source_entity_id`

#### Migration 004: Supporting Tables

**`public.agent_versions`** - Version history for agents
- Stores snapshots of agent configurations
- Includes all fields from agents table
- Limited to 10 versions per agent (configurable)

**`public.agent_ratings`** - Overall agent ratings
- Separate from execution ratings
- Allows rating the agent concept itself

**`public.agent_input_versions`** - Input field version history
- Stores historical states of inputs_raw field
- Limited to 5 versions per agent (configurable)

**`public.module_versions`** - Module templates and history
- Stores reusable module configurations
- Supports templates for quick module setup

All supporting tables have appropriate RLS policies and indexes.

---

## Edge Functions

### Overview

The package requires **4 Edge Functions** to be deployed to your Supabase project:

1. **test-agent** - Main agent execution engine
2. **check-and-execute-triggers** - Trigger management system
3. **list-tables** - Dynamic table listing for UI
4. **list-columns** - Dynamic column listing for UI

### 1. test-agent

**Purpose**: Core agent execution engine that processes all module types and returns detailed execution logs.

**Path**: `supabase/functions/test-agent/index.ts`

**Required Secrets**:
- `XAI_API_KEY` - For X.AI/Grok models

**Features**:
- Processes all module types in sequence:
  - **Inputs Module**: Resolves input values from context
  - **Prompt Module**: Builds final prompt with variable substitution
  - **Model Module**: Calls AI API with configured model
  - **JSON Extractor Module**: Extracts structured data using JSONPath
  - **Router Module**: Evaluates conditions and routes to destinations
  - **Destinations Module**: Writes to database or triggers UI events
- Auto-fills special inputs:
  - `all_tasks_list` - Loads all tasks from database
  - `profile_*` - Loads user profile data
  - `task_*` - Loads specific task data
- Structured output for JSON Extractor (when needed)
- Comprehensive error handling
- Detailed `modules_chain` logging for debugging

**Invocation**:
```typescript
const { data, error } = await supabase.functions.invoke('test-agent', {
  body: {
    agentId: 'uuid-here',
    context: {
      source: 'test', // or 'trigger', 'manual'
      taskId: 'uuid-here', // optional
      userId: 'uuid-here', // optional
    },
  },
});
```

**Response**:
```json
{
  "success": true,
  "execution": {
    "id": "execution-uuid",
    "output": "Final agent output",
    "modules_chain": [
      {
        "moduleId": "inputs-id",
        "moduleName": "inputs",
        "status": "success",
        "output": { "resolved_inputs": {...} }
      },
      {
        "moduleId": "prompt-id",
        "moduleName": "prompt",
        "status": "success",
        "output": { "final_prompt": "..." }
      },
      // ... more modules
    ]
  }
}
```

### 2. check-and-execute-triggers

**Purpose**: Universal trigger handler that evaluates trigger conditions and executes agents when conditions are met.

**Path**: `supabase/functions/check-and-execute-triggers/index.ts`

**Required Secrets**:
- `XAI_API_KEY` - For X.AI/Grok models

**Features**:
- Handles all trigger types:
  - `on_create` - When entity is created
  - `on_update` - When entity is updated
  - `scheduled` - Time-based triggers (via pg_cron)
  - `on_demand` - Manual user-triggered execution
- Evaluates complex condition logic (AND/OR with brackets)
- Logs all trigger events to `trigger_executions` table
- Calls `test-agent` function when conditions are met
- Supports custom `changedFields` filtering for `on_update`

**Invocation** (from database trigger):
```sql
-- Called automatically by database triggers
SELECT pg_net.http_post(
  url := 'https://your-project.supabase.co/functions/v1/check-and-execute-triggers',
  headers := '{"Content-Type": "application/json"}'::jsonb,
  body := jsonb_build_object(
    'triggerType', 'on_update',
    'sourceEntityType', 'tasks',
    'sourceEntityId', NEW.id,
    'changedFields', changed_fields_array
  )
);
```

**Setup with pg_cron** (for scheduled triggers):
```sql
-- Run every 5 minutes
SELECT cron.schedule(
  'check-scheduled-triggers',
  '*/5 * * * *',
  $$ 
    SELECT pg_net.http_post(
      url := 'https://your-project.supabase.co/functions/v1/check-and-execute-triggers',
      headers := '{"Content-Type": "application/json"}'::jsonb,
      body := '{"triggerType": "scheduled"}'::jsonb
    );
  $$
);
```

### 3. list-tables

**Purpose**: Returns list of all public tables in the database for dynamic UI selection.

**Path**: `supabase/functions/list-tables/index.ts`

**Required Database Functions**:
- `get_public_tables()` - Must be created before deployment

**Features**:
- Lists all tables in `public` schema
- Used by Destinations Editor for table selection
- Cached for performance

**Invocation**:
```typescript
const { data } = await supabase.functions.invoke('list-tables');
// Returns: [{ table_name: "tasks", table_schema: "public" }, ...]
```

### 4. list-columns

**Purpose**: Returns columns for a specific table for dynamic UI selection.

**Path**: `supabase/functions/list-columns/index.ts`

**Required Database Functions**:
- `get_table_columns(table_name)` - Must be created before deployment

**Features**:
- Lists all columns for specified table
- Includes data type and nullable information
- Used by Destinations Editor for column selection

**Invocation**:
```typescript
const { data } = await supabase.functions.invoke('list-columns', {
  body: { table_name: 'tasks' },
});
// Returns: [{ column_name: "title", data_type: "text", is_nullable: "NO" }, ...]
```

---

## Configuration

### 1. Environment Variables

Create `.env` file in project root:

```env
# Supabase Configuration (Required)
VITE_SUPABASE_URL=https://xxxxxxxxxxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
VITE_SUPABASE_PUBLISHABLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Optional: Custom configuration
VITE_AGENT_SYSTEM_TABLE_PREFIX=my_
```

### 2. Supabase Secrets

Set required secrets in your Supabase project:

**Via Supabase CLI:**
```bash
npx supabase secrets set XAI_API_KEY=xai-your-api-key-here
```

**Via Lovable Cloud UI:**
1. Open your project
2. Go to Cloud → Settings → Secrets
3. Click "Add Secret"
4. Name: `XAI_API_KEY`
5. Value: Your X.AI API key
6. Click "Save"

**Required Secrets:**
- `XAI_API_KEY` - For Grok models (get from https://console.x.ai/)

**Automatically Available Secrets:**
- `SUPABASE_URL` - Your project URL
- `SUPABASE_ANON_KEY` - Public anon key
- `SUPABASE_SERVICE_ROLE_KEY` - Admin key (use with caution)

### 3. Supabase config.toml

Update `supabase/config.toml` to configure Edge Functions:

```toml
[functions.test-agent]
verify_jwt = false  # Allow public access for testing

[functions.check-and-execute-triggers]
verify_jwt = false  # Called by database triggers

[functions.list-tables]
verify_jwt = false  # Used by UI

[functions.list-columns]
verify_jwt = false  # Used by UI
```

**Important**: Set `verify_jwt = false` for all functions if you want them accessible without authentication. In production, consider implementing proper auth.

### 4. Optional: Agent System Config

Create `agent-system.config.ts` for custom table/function names:

```typescript
export const agentSystemConfig = {
  // Custom table names (optional)
  tables: {
    agents: 'agents',                    // default: 'agents'
    executions: 'agent_executions',      // default: 'agent_executions'
    triggers: 'trigger_executions',      // default: 'trigger_executions'
    versions: 'agent_versions',          // default: 'agent_versions'
    ratings: 'agent_ratings',            // default: 'agent_ratings'
    inputVersions: 'agent_input_versions', // default: 'agent_input_versions'
    moduleVersions: 'module_versions',   // default: 'module_versions'
  },
  
  // Custom function names (optional)
  functions: {
    testAgent: 'test-agent',                        // default: 'test-agent'
    checkTriggers: 'check-and-execute-triggers',    // default: 'check-and-execute-triggers'
    listTables: 'list-tables',                      // default: 'list-tables'
    listColumns: 'list-columns',                    // default: 'list-columns'
  },
};
```

---

## Integration Steps

### Step 1: Install Package

```bash
npm install @lovable/agent-system
```

### Step 2: Install Peer Dependencies

Check which peer dependencies you're missing:

```bash
npm info @lovable/agent-system peerDependencies
```

Install all required peer dependencies:

```bash
npm install react@^18.3.1 react-dom@^18.3.1 \
  @supabase/supabase-js@^2.76.1 \
  @dnd-kit/core@^6.3.1 @dnd-kit/sortable@^10.0.0 @dnd-kit/utilities@^3.2.2 \
  lucide-react@^0.462.0 \
  @radix-ui/react-dialog@^1.1.14 @radix-ui/react-select@^2.2.5 \
  @radix-ui/react-tabs@^1.1.12 @radix-ui/react-popover@^1.1.14 \
  @radix-ui/react-scroll-area@^1.2.9 @radix-ui/react-tooltip@^1.2.7 \
  @radix-ui/react-separator@^1.1.7 @radix-ui/react-switch@^1.2.5 \
  @radix-ui/react-label@^2.1.7 @radix-ui/react-checkbox@^1.3.2 \
  @radix-ui/react-hover-card@^1.1.14 @radix-ui/react-dropdown-menu@^2.1.15 \
  @radix-ui/react-slot@^1.2.3 \
  @tiptap/react@^3.7.2 @tiptap/starter-kit@^3.7.2 \
  @tiptap/extension-placeholder@^3.7.2 @tiptap/extension-image@^3.7.2 \
  @tiptap/extension-mention@^3.7.2 @tiptap/extension-task-list@^3.7.2 \
  @tiptap/extension-task-item@^3.7.2 @tiptap/extension-highlight@^3.7.2 \
  @tiptap/suggestion@^3.7.2 \
  cmdk@^1.1.1 class-variance-authority@^0.7.1 \
  date-fns@^3.6.0 recharts@^2.15.4 sonner@^1.7.4
```

### Step 3: Setup Required External Components

Create the following files in your project:

**3.1 Supabase Client** (`src/integrations/supabase/client.ts`):
```typescript
import { createClient } from '@supabase/supabase-js';

export const supabase = createClient(
  import.meta.env.VITE_SUPABASE_URL,
  import.meta.env.VITE_SUPABASE_ANON_KEY
);
```

**3.2 Toast Hook** (`src/hooks/use-toast.ts`):
```typescript
import { toast as sonnerToast } from 'sonner';

export const useToast = () => {
  const toast = ({ title, description, variant }: {
    title?: string;
    description?: string;
    variant?: 'default' | 'destructive';
  }) => {
    if (variant === 'destructive') {
      sonnerToast.error(title || 'Error', { description });
    } else {
      sonnerToast.success(title || 'Success', { description });
    }
  };
  return { toast };
};
```

**3.3 Utils** (`src/lib/utils.ts`):
```typescript
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

**3.4 Install shadcn/ui components** (if not present):
```bash
npx shadcn-ui@latest init
npx shadcn-ui@latest add button dialog tabs select popover scroll-area tooltip separator switch label checkbox hover-card dropdown-menu badge card input textarea command alert sonner
```

### Step 4: Initialize Agent System

Run the CLI tool to copy migrations and edge functions:

```bash
npx agent-system init
```

This will:
- Copy 4 SQL migration files to `supabase/migrations/`
- Copy 4 edge functions to `supabase/functions/`
- Create `agent-system.config.ts` (optional)

### Step 5: Create Required Database Functions

**CRITICAL**: Create these functions BEFORE applying migrations!

```sql
-- 1. Update timestamp function (required by migrations)
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- 2. List tables function (required by list-tables edge function)
CREATE OR REPLACE FUNCTION get_public_tables()
RETURNS TABLE(table_name text, table_schema text)
LANGUAGE sql STABLE SECURITY DEFINER
SET search_path TO 'public'
AS $$
  SELECT table_name::text, table_schema::text
  FROM information_schema.tables
  WHERE table_schema = 'public' 
    AND table_type = 'BASE TABLE'
  ORDER BY table_name;
$$;

-- 3. List columns function (required by list-columns edge function)
CREATE OR REPLACE FUNCTION get_table_columns(p_table_name text)
RETURNS TABLE(column_name text, data_type text, is_nullable text)
LANGUAGE sql STABLE SECURITY DEFINER
SET search_path TO 'public'
AS $$
  SELECT column_name::text, data_type::text, is_nullable::text
  FROM information_schema.columns
  WHERE table_schema = 'public' 
    AND table_name = p_table_name
  ORDER BY ordinal_position;
$$;
```

### Step 6: Apply Database Migrations

**Via Lovable Cloud UI:**
1. Open your project
2. Go to Cloud → Database → Migrations
3. Upload the 4 migration files from `supabase/migrations/`
4. Click "Apply" for each migration in order

**Via Supabase CLI:**
```bash
npx supabase db push
```

**Verify migrations were applied:**
```sql
-- Check if tables exist
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
  AND table_name IN ('agents', 'agent_executions', 'trigger_executions', 'agent_versions');
```

### Step 7: Configure Secrets

Set the X.AI API key:

```bash
npx supabase secrets set XAI_API_KEY=xai-your-key-here
```

**Get X.AI API Key:**
1. Go to https://console.x.ai/
2. Sign up / Log in
3. Navigate to API Keys section
4. Create new API key
5. Copy the key (starts with `xai-`)

### Step 8: Update supabase/config.toml

Add Edge Function configurations:

```toml
[functions.test-agent]
verify_jwt = false

[functions.check-and-execute-triggers]
verify_jwt = false

[functions.list-tables]
verify_jwt = false

[functions.list-columns]
verify_jwt = false
```

### Step 9: Deploy Edge Functions

**Automatic deployment (recommended):**
```bash
npx agent-system deploy
```

**Manual deployment:**
```bash
npx supabase functions deploy test-agent
npx supabase functions deploy check-and-execute-triggers
npx supabase functions deploy list-tables
npx supabase functions deploy list-columns
```

**Verify deployment:**
```bash
npx supabase functions list
```

### Step 10: Integrate into React Application

**10.1 Wrap App with AgentSystemProvider** (`src/App.tsx`):

```typescript
import { AgentSystemProvider } from '@lovable/agent-system';

function App() {
  return (
    <AgentSystemProvider
      config={{
        supabaseUrl: import.meta.env.VITE_SUPABASE_URL,
        supabaseKey: import.meta.env.VITE_SUPABASE_ANON_KEY,
      }}
    >
      {/* Your app routes and components */}
    </AgentSystemProvider>
  );
}

export default App;
```

**10.2 Use AgentDialog in Your Pages** (`src/pages/Agents.tsx`):

```typescript
import { useState } from 'react';
import { AgentDialog } from '@lovable/agent-system';
import { supabase } from '@/integrations/supabase/client';
import { useToast } from '@/hooks/use-toast';
import { Button } from '@/components/ui/button';

export function AgentsPage() {
  const [isDialogOpen, setIsDialogOpen] = useState(false);
  const [selectedAgent, setSelectedAgent] = useState(null);
  const { toast } = useToast();

  const handleCreateAgent = () => {
    setSelectedAgent(null);
    setIsDialogOpen(true);
  };

  const handleSaveAgent = () => {
    toast({
      title: 'Agent saved successfully',
      description: 'Your agent has been saved to the database.',
    });
    setIsDialogOpen(false);
  };

  return (
    <div className="container mx-auto py-8">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-3xl font-bold">Agents</h1>
        <Button onClick={handleCreateAgent}>
          Create Agent
        </Button>
      </div>

      <AgentDialog
        agent={selectedAgent}
        open={isDialogOpen}
        onOpenChange={setIsDialogOpen}
        onSave={handleSaveAgent}
        supabaseClient={supabase}
        toast={toast}
      />
    </div>
  );
}
```

**10.3 Add Toaster Component** (`src/App.tsx`):

```typescript
import { Toaster } from '@/components/ui/sonner';

function App() {
  return (
    <AgentSystemProvider config={...}>
      {/* Your app */}
      <Toaster />
    </AgentSystemProvider>
  );
}
```

---

## Verification Checklist

After integration, verify the following:

### ✅ Dependencies
- [ ] All peer dependencies installed
- [ ] Tailwind CSS configured
- [ ] shadcn/ui components present (21 components)
- [ ] UI компонент `table.tsx` создан в `src/components/ui/`
- [ ] UI компоненты `toast.tsx` и `toaster.tsx` созданы (если используется Option A для toast)

### ✅ Database
- [ ] `update_updated_at_column()` function created
- [ ] `get_public_tables()` function created
- [ ] `get_table_columns()` function created
- [ ] 4 migration files applied
- [ ] Tables exist: `agents`, `agent_executions`, `trigger_executions`, `agent_versions`, `agent_ratings`, `agent_input_versions`, `module_versions`
- [ ] RLS policies active

### ✅ Edge Functions
- [ ] `test-agent` deployed
- [ ] `check-and-execute-triggers` deployed
- [ ] `list-tables` deployed
- [ ] `list-columns` deployed
- [ ] `supabase/config.toml` updated
- [ ] `XAI_API_KEY` secret configured

### ✅ React Integration
- [ ] `AgentSystemProvider` wraps app
- [ ] Supabase client passed to `AgentDialog`
- [ ] Toast function passed to `AgentDialog`
- [ ] `Toaster` component rendered
- [ ] `AgentDialog` opens without errors

### ✅ Functionality
- [ ] Can create new agent
- [ ] Can add modules to agent
- [ ] Can test agent (test button works)
- [ ] Execution logs display correctly
- [ ] `modules_chain` shows in test results
- [ ] Can save agent to database
- [ ] Can view execution history
- [ ] Can rate agent/execution

---

## Troubleshooting

### Issue: "Module not found: @radix-ui/..."

**Cause**: Missing peer dependencies

**Solution**:
```bash
npm install @radix-ui/react-dialog @radix-ui/react-select ...
# Install all missing packages listed in error
```

### Issue: "XAI_API_KEY is not configured"

**Cause**: Secret not set in Supabase project

**Solution**:
```bash
npx supabase secrets set XAI_API_KEY=xai-your-key
```

**Verify:**
```bash
npx supabase secrets list
```

### Issue: "Table agents does not exist"

**Cause**: Migrations not applied

**Solution**:
1. Check migrations exist: `ls supabase/migrations/`
2. Apply migrations: `npx supabase db push`
3. Verify: `psql -h ... -U postgres -c "SELECT * FROM agents LIMIT 1;"`

### Issue: "Function update_updated_at_column does not exist"

**Cause**: Required function not created before migrations

**Solution**:
```sql
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

Then re-run migrations.

### Issue: "Edge function returns 500 error"

**Cause**: Function not deployed or misconfigured

**Solution**:
1. Check function logs: `npx supabase functions logs test-agent`
2. Verify deployment: `npx supabase functions list`
3. Redeploy: `npx supabase functions deploy test-agent`
4. Check `config.toml` has correct settings

### Issue: "AgentDialog not showing"

**Cause**: Missing UI components or styling

**Solution**:
1. Install shadcn/ui components: `npx shadcn-ui@latest add dialog tabs button ...`
2. Verify Tailwind configured correctly
3. Check `Toaster` component is rendered
4. Check browser console for errors

### Issue: "Cannot read properties of undefined (reading 'functions')"

**Cause**: Supabase client not passed correctly

**Solution**:
```typescript
<AgentDialog
  supabaseClient={supabase}  // ← Must pass instance
  toast={toast}               // ← Must pass function
  // ... other props
/>
```

### Issue: "Modules not saving to database"

**Cause**: Race condition in state updates

**Solution**: This is fixed in latest version. Update package:
```bash
npm update @lovable/agent-system
```

### Issue: "Destinations Editor shows no tables/columns"

**Cause**: Database functions not created or edge functions not deployed

**Solution**:
1. Create `get_public_tables()` and `get_table_columns()` functions
2. Deploy `list-tables` and `list-columns` edge functions
3. Restart application

---

## Advanced Configuration

### Custom Table Names

If you need custom table names (e.g., prefixed tables):

**1. Create config file** (`agent-system.config.ts`):
```typescript
export const agentSystemConfig = {
  tables: {
    agents: 'my_agents',
    executions: 'my_agent_executions',
    triggers: 'my_trigger_executions',
    versions: 'my_agent_versions',
    ratings: 'my_agent_ratings',
    inputVersions: 'my_agent_input_versions',
    moduleVersions: 'my_module_versions',
  },
};
```

**2. Update migration files** before applying:
```sql
-- Change all occurrences of 'agents' to 'my_agents', etc.
CREATE TABLE public.my_agents ( ... );
```

**3. Update edge functions** to use custom table names.

### Custom Edge Function Names

If you need custom function names:

**1. Update config** (`agent-system.config.ts`):
```typescript
export const agentSystemConfig = {
  functions: {
    testAgent: 'my-test-agent',
    checkTriggers: 'my-check-triggers',
    listTables: 'my-list-tables',
    listColumns: 'my-list-columns',
  },
};
```

**2. Rename function folders** in `supabase/functions/`

**3. Update `config.toml`** with new names

**4. Update frontend calls** to use new function names

### Adding Custom Modules

You can extend the agent system with custom modules:

**1. Define module** (`src/modules/custom/CustomModule.ts`):
```typescript
import { IModuleDefinition } from '@lovable/agent-system';

export const CustomModule: IModuleDefinition = {
  type: 'custom',
  label: 'Custom Module',
  icon: CustomIcon,
  color: 'hsl(var(--chart-5))',
  getDefaultConfig: () => ({ customField: '' }),
  validateConfig: (config) => ({
    valid: !!config.customField,
    errors: config.customField ? [] : [{ field: 'customField', message: 'Required' }],
  }),
  EditorComponent: CustomEditor,
  PreviewComponent: CustomPreview,
  getDynamicOutputs: (config, moduleId) => [],
};
```

**2. Register module**:
```typescript
import { moduleRegistry } from '@lovable/agent-system';
import { CustomModule } from './modules/custom/CustomModule';

moduleRegistry.register(CustomModule);
```

**3. Handle in backend** (`test-agent` edge function)

### Image Upload Integration

If your agents need image upload capabilities:

```typescript
<AgentDialog
  supabaseClient={supabase}
  toast={toast}
  onImageUpload={async (file: File) => {
    // Upload to Supabase Storage
    const { data, error } = await supabase.storage
      .from('agent-images')
      .upload(`${Date.now()}-${file.name}`, file);
    
    if (error) return null;
    
    // Return public URL
    const { data: { publicUrl } } = supabase.storage
      .from('agent-images')
      .getPublicUrl(data.path);
    
    return publicUrl;
  }}
/>
```

### Trigger System Setup (Optional)

To enable automatic trigger execution on database changes:

**1. Enable pg_net extension:**
```sql
CREATE EXTENSION IF NOT EXISTS pg_net;
```

**2. Create notification function:**
```sql
CREATE OR REPLACE FUNCTION notify_trigger_manager()
RETURNS TRIGGER AS $$
DECLARE
  changed_fields text[];
BEGIN
  -- Determine changed fields
  IF TG_OP = 'UPDATE' THEN
    changed_fields := ARRAY(
      SELECT jsonb_object_keys(to_jsonb(NEW)) 
      WHERE to_jsonb(NEW) != to_jsonb(OLD)
    );
  END IF;

  -- Call edge function asynchronously
  PERFORM pg_net.http_post(
    url := current_setting('app.settings.supabase_url') || '/functions/v1/check-and-execute-triggers',
    headers := '{"Content-Type": "application/json"}'::jsonb,
    body := jsonb_build_object(
      'triggerType', CASE WHEN TG_OP = 'INSERT' THEN 'on_create' ELSE 'on_update' END,
      'sourceEntityType', TG_TABLE_NAME,
      'sourceEntityId', NEW.id,
      'changedFields', changed_fields
    )
  );

  RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

**3. Create triggers on your tables:**
```sql
-- For tasks table
CREATE TRIGGER on_tasks_insert
AFTER INSERT ON public.tasks
FOR EACH ROW EXECUTE FUNCTION notify_trigger_manager();

CREATE TRIGGER on_tasks_update
AFTER UPDATE ON public.tasks
FOR EACH ROW EXECUTE FUNCTION notify_trigger_manager();
```

**4. Setup pg_cron for scheduled triggers:**
```sql
SELECT cron.schedule(
  'check-scheduled-triggers',
  '*/5 * * * *',  -- Every 5 minutes
  $$ 
    SELECT pg_net.http_post(
      url := current_setting('app.settings.supabase_url') || '/functions/v1/check-and-execute-triggers',
      headers := '{"Content-Type": "application/json"}'::jsonb,
      body := '{"triggerType": "scheduled"}'::jsonb
    );
  $$
);
```

---

## Production Considerations

### Security

**1. Enable Row Level Security (RLS)**

The migrations include RLS policies, but review them for your use case:

```sql
-- Example: Restrict agent viewing to owners only
CREATE POLICY "Users can view their own agents"
  ON public.agents FOR SELECT
  USING (auth.uid() = created_by);
```

**2. Secure Edge Functions**

In production, enable JWT verification:

```toml
[functions.test-agent]
verify_jwt = true  # Require authentication
```

**3. Use Service Role Key Carefully**

Never expose `SUPABASE_SERVICE_ROLE_KEY` to frontend. Only use in trusted backend functions.

**4. Implement Rate Limiting**

Add rate limiting to prevent abuse:

```typescript
// In edge function
const rateLimit = await checkRateLimit(userId);
if (!rateLimit.allowed) {
  return new Response('Rate limit exceeded', { status: 429 });
}
```

### Performance

**1. Index Optimization**

The migrations include basic indexes. Add more for your queries:

```sql
CREATE INDEX idx_agents_model ON public.agents(model);
CREATE INDEX idx_executions_status_created 
  ON public.agent_executions(status, created_at DESC);
```

**2. Connection Pooling**

Use Supabase connection pooling in production:
```typescript
const supabase = createClient(url, key, {
  db: { schema: 'public' },
  auth: { persistSession: false },
  global: { headers: { 'x-connection-pool': 'true' } },
});
```

**3. Edge Function Cold Starts**

Keep functions warm with periodic health checks:
```bash
*/5 * * * * curl https://your-project.supabase.co/functions/v1/test-agent/health
```

### Monitoring

**1. Enable Function Logs**

Monitor edge function logs:
```bash
npx supabase functions logs test-agent --tail
```

**2. Track Execution Metrics**

Query execution statistics:
```sql
SELECT 
  status,
  COUNT(*) as count,
  AVG(duration_ms) as avg_duration,
  MAX(duration_ms) as max_duration
FROM agent_executions
WHERE created_at > NOW() - INTERVAL '24 hours'
GROUP BY status;
```

**3. Set Up Alerts**

Create alerts for error spikes:
```sql
-- Check for error rate > 10%
SELECT 
  COUNT(*) FILTER (WHERE status = 'error') * 100.0 / COUNT(*) as error_rate
FROM agent_executions
WHERE created_at > NOW() - INTERVAL '1 hour';
```

### Backup and Recovery

**1. Database Backups**

Supabase provides automatic backups. Verify:
- Daily backups enabled
- Point-in-time recovery (PITR) configured

**2. Export Agent Configurations**

Regularly export critical agents:
```sql
COPY (
  SELECT * FROM agents WHERE status = 'production'
) TO '/path/to/backup.csv' WITH CSV HEADER;
```

**3. Version Control**

Use agent versions for rollback:
```typescript
// Restore previous version
const { data } = await supabase
  .from('agent_versions')
  .select('*')
  .eq('agent_id', agentId)
  .order('created_at', { ascending: false })
  .limit(1)
  .single();

// Apply to agent
await supabase
  .from('agents')
  .update(data)
  .eq('id', agentId);
```

---

## Support and Resources

### Documentation
- **Package README**: [agent-system-package/README.md](./README.md)
- **Integration Guide**: [agent-system-package/INTEGRATION_GUIDE.md](./INTEGRATION_GUIDE.md)
- **Backend Sync Status**: [agent-system-package/BACKEND_SYNC.md](./BACKEND_SYNC.md)

### Community
- **GitHub Issues**: [Report bugs or request features](https://github.com/your-org/agent-system/issues)
- **Discord**: [Join our community](https://discord.gg/your-invite)

### API Reference
- **Supabase JS Docs**: https://supabase.com/docs/reference/javascript
- **Radix UI Docs**: https://www.radix-ui.com/docs/primitives
- **Tiptap Docs**: https://tiptap.dev/docs

### Version Compatibility

| @lovable/agent-system | React | Supabase JS | Node.js |
|----------------------|-------|-------------|---------|
| 1.0.x                | 18.x  | 2.76.x      | 18.x    |
| 1.0.x                | 19.x  | 2.76.x      | 18.x    |

---

## License

This package is licensed under MIT License.

---

## Changelog

### 1.0.0 (Initial Release)
- ✅ AgentDialog component with full module support
- ✅ Module types: Trigger, Prompt, Model, JSON Extractor, Router, Destinations
- ✅ Database migrations for all agent tables
- ✅ Edge functions: test-agent, check-and-execute-triggers, list-tables, list-columns
- ✅ Comprehensive version control system
- ✅ Execution logging with modules_chain
- ✅ Rating system for agents and executions
- ✅ CLI tools for initialization and deployment

---

**🎉 Congratulations! You've successfully integrated @lovable/agent-system into your project.**

For additional help, please refer to the troubleshooting section or reach out to our support channels.
